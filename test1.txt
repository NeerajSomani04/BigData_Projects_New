Below are commands used to perform some activity -->

Below command to create Hive database --> 
CREATE DATABASE IF NOT EXISTS Viacom_Test; 

CREATE TABLE IF NOT EXISTS comment_text (
message STRING,
id STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

Load data local inpath '/home/dkothari/vi-com/BigData_Projects_New/comment_text' into table comment_text;

describe formatted comment_text; --> this command can be used to see the details of hive table.

Below is the hive dataware house location for our database -->
hdfs://nn01.itversity.com:8020/apps/hive/warehouse/viacom_test.db/comment_text

hdfs dfs -put /home/dkothari/vi-com/BigData_Projects_New/post_meta/ vi-com/BigData_Project/post_meta

Below command is for post_meta parquet files --  COMPRESSED WITH SNAPPY

Drop table post_meta;

CREATE EXTERNAL TABLE IF NOT EXISTS post_meta (post_h_id STRING, post_created_time TIMESTAMP, name_h_id STRING, type STRING) 
STORED AS PARQUET 
TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY');

Load data local inpath '/home/dkothari/vi-com/BigData_Projects_New/post_meta' into table post_meta;

describe formatted post_meta;

Drop table comment_info_jsonl;

CREATE EXTERNAL TABLE IF NOT EXISTS comment_info_jsonl (
text STRING)
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe';

CREATE EXTERNAL TABLE IF NOT EXISTS comment_info_jsonl (
h_id STRING
, posts struct< 
data: array < struct <
comments: struct < 
data: array< struct < 
comment_count: INT
, comments: struct < 
data: array < struct < 
comment_count: INT
, created_time: STRING
, h_id: STRING
, parent: struct < 
h_id: STRING
>
, up_likes: INT
> > >
, created_time: STRING
, h_id: STRING
, up_likes: INT 
> > >
, h_id: STRING 
> > >
)
ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
STORED AS TEXTFILE;

I downloaded jar from below path --
http://snowplow-hosted-assets.s3.amazonaws.com/third-party/rcongiu/json-serde-1.1.6-jar-with-dependencies.jar

add jar /home/dkothari/json-serde-1.1.6-jar-with-dependencies.jar; -- this command added the jar in hive consol.

-- this serde is working -- 'org.apache.hive.hcatalog.data.JsonSerDe'
we might need this serde -- org.openx.data.jsonserde.JsonSerDe 

Load data local inpath '/home/dkothari/vi-com/BigData_Projects_New/comment_info_jsonl' into table comment_info_jsonl;


Links for comments and posts Hive data model 

Nice hive example article:
https://medium.com/datadriveninvestor/analyzing-twitter-feeds-using-hive-7e074025f295

https://blog.cloudera.com/blog/2012/11/analyzing-twitter-data-with-hadoop-part-3-querying-semi-structured-data-with-hive/

https://github.com/rcongiu/Hive-JSON-Serde

https://www.google.com/search?q=relational+data+model+to+store+facebook+post+comments&tbm=isch&source=hp&safe=active&sa=X&ved=2ahUKEwiW2v2M7IzgAhXLT98KHWmnDscQsAR6BAgAEAE

https://data.stackexchange.com/stackoverflow/query/new

https://dba.stackexchange.com/questions/174878/how-to-store-likes-and-comments-of-posts-in-database

Below are few links to work on ElasticSearch for the data load and analysis:
https://gist.github.com/vinodnerella/15dabed07ac4815e4792d63cf8e4ed51

https://medium.com/@ashish_fagna/getting-started-with-elasticsearch-creating-indices-inserting-values-and-retrieving-data-e3122e9b12c6

https://github.com/Moshe/elasticsearch_loader

Elastic Search deep dive on linux academy
https://dzone.com/articles/what-is-elasticsearch-and-how-it-can-be-useful

https://www.elastic.co/blog/found-elasticsearch-as-nosql
